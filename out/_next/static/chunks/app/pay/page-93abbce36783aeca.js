(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7772],{46601:function(){},89214:function(){},85568:function(){},69386:function(){},31616:function(){},29120:function(){},46586:function(){},71156:function(){},88924:function(){},55024:function(){},50617:function(e,t,s){Promise.resolve().then(s.bind(s,92311))},92311:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return page}});var n=s(57437),r=s(49080),a=s(37656),i=s(45329),l=s(31040),o=s.n(l),c=s(19258),d=s(2265),u=s(31379),f=s(23611),pay_LoginWithMonerium=function(e){let{safe:t,threshold:s,onLogin:r}=e;return(0,n.jsxs)("div",{className:"flex flex-col items-center gap-4 mt-12",children:[(0,n.jsx)("div",{className:"text-xl font-600 ",children:"Safe wallet Connected !!"}),(0,n.jsxs)("div",{className:"mt-4",children:["You are connected and have selected the following Safe:"," ",(0,n.jsxs)("div",{className:"border px-2 py-1 my-2 border-gray-600 rounded-md flex flex-row gap-4",children:[(0,n.jsx)(u.Z,{address:t,showBlockExplorerLink:!0,useFullAddress:!0})," "," ","  (",s,")"]})]}),(0,n.jsx)("div",{className:"mt-4",children:"You now can login with Monerium and link the selected Safe with your account"}),(0,n.jsx)("button",{onClick:r,className:(0,f.d)(),children:"Login with Monerium"})]})},ibanDetails=e=>{let{authContext:t,profile:s,balances:a,orders:i}=e,{selectedSafe:l}=(0,r.useAuth)(),o=null==s?void 0:s.accounts,c=null==o?void 0:o.find(e=>"eur"===e.currency.toLowerCase()&&e.address.toLowerCase()===l.toLowerCase()&&"goerli"===e.network),[f,x]=(0,d.useState)(""),handleDisplayOrder=e=>{x(e)};return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-3xl font-800 font-medium text-muted-foreground text-center my-4",children:"Orders"}),(0,n.jsx)("div",{className:"px-2 flex flex-col gap-2",children:i?(0,n.jsx)(n.Fragment,{children:null==i?void 0:i.map(e=>{if(e.accountId===(null==c?void 0:c.id))return(0,n.jsxs)("div",{className:"flex flex-col gap-2 cursor-pointer ",children:[(0,n.jsxs)("div",{onClick:()=>handleDisplayOrder(e.id),className:"".concat(f==e.id?"border-gray-800":""," flex flex-row rounded-md justify-between border cursor-pointer font-500 text-lg tracking-tight px-4 py-2"),children:[(0,n.jsx)("div",{children:e.counterpart.details.name?e.counterpart.details.name:"Unknown"}),(0,n.jsx)("div",{children:e.counterpart.identifier.iban?e.counterpart.identifier.iban:"NA"}),(0,n.jsxs)("div",{children:["-€",e.meta.sentAmount]})]}),(0,n.jsxs)("div",{className:"".concat(f==e.id?"flex":"hidden"," md:flex-row flex-col px-4 py-2 gap-8 border rounded-md rounded-t-none"),children:[(0,n.jsxs)("div",{className:"flex flex-col gap-2 flex-1",children:[(0,n.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,n.jsx)("div",{className:"text-lg font-600",children:"IBAN"}),(0,n.jsx)("div",{className:"text-sm font-400 text-grey-400",children:e.counterpart.identifier.iban?e.counterpart.identifier.iban:"NA"})]}),(0,n.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,n.jsx)("div",{className:"text-lg font-600",children:"Name"}),(0,n.jsx)("div",{className:"text-sm font-400 text-grey-400",children:e.counterpart.details.name?e.counterpart.details.name:"Unknown"})]}),(0,n.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,n.jsx)("div",{className:"text-lg font-600",children:"Reference / Memo"}),(0,n.jsx)("div",{className:"text-sm font-400 text-grey-400",children:e.memo})]}),(0,n.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,n.jsx)("div",{className:"text-lg font-600",children:"Transaction"}),(0,n.jsx)("div",{className:"text-sm font-400 text-grey-400",children:(0,n.jsx)(u.Z,{address:null==e?void 0:e.txHashes[0],showBlockExplorerLink:!0})})]})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-2 flex-1",children:[(0,n.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,n.jsx)("div",{className:"text-lg font-600",children:"Amount sent from wallet"}),(0,n.jsxs)("div",{className:"text-sm font-400 text-grey-400",children:["-€",e.meta.sentAmount]})]}),(0,n.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,n.jsx)("div",{className:"text-lg font-600",children:"Status"}),(0,n.jsx)("div",{className:"text-sm font-400 text-grey-400",children:e.meta.state})]})]})]})]})})}):(0,n.jsx)(n.Fragment,{children:"No Orders yet"})})]})},x=s(14977),Userbalance=e=>{let{closeMoneriumFlow:t,balances:s}=e,{selectedSafe:a}=(0,r.useAuth)(),i=null==s?void 0:s.filter(e=>e.address.toLowerCase()===a.toLowerCase());return(0,n.jsxs)("div",{className:"flex flex-col gap-16 justify-between my-12",children:[(0,n.jsxs)("div",{className:"flex gap-8 flex-col",children:[(0,n.jsx)("div",{className:"text-3xl font-500 leading-tight tracking-tighter",children:"User Balance"}),(0,n.jsx)("div",{children:null==i?void 0:i.map((e,t)=>(0,n.jsxs)("div",{className:"flex gap-4",children:[(0,n.jsxs)("div",{className:"flex gap-1 text-xl capitalize",children:[(0,n.jsx)("div",{children:e.chain}),(0,n.jsx)("div",{children:e.network})]}),(0,n.jsx)("div",{className:"text-lg text-gray-500",children:e.balances.map(e=>(0,n.jsxs)("div",{className:"flex gap-1",children:[(0,n.jsx)("div",{className:"uppercase",children:e.currency}),(0,n.jsx)("div",{children:e.amount})]},"".concat(e.currency,"-").concat(e.amount)))})]},t))})]}),(0,n.jsx)("div",{className:"flex justify-start my-4",children:(0,n.jsx)("button",{className:(0,f.d)(),onClick:t,children:"Log Out Memorium"})})]})},m=s(88216),pay_PayForm=e=>{let{moneriumClient:t,closeMoneriumFlow:s,protocolKit:i,moneriumPack:l,balances:o}=e,{isLoggedIn:c,selectedSafe:u,provider:h,safeSDKKit:g}=(0,r.useAuth)(),[v,p]=(0,d.useState)(!1),[j,w]=(0,d.useState)(""),[y,b]=(0,d.useState)(""),[N,S]=(0,d.useState)(""),[A,k]=(0,d.useState)(0),[C,I]=(0,d.useState)(""),[P,E]=(0,d.useState)();(0,d.useEffect)(()=>{(P===a.Kq.processed||P===a.Kq.rejected)&&(w(""),setTimeout(()=>{p(!1)},5e3))},[P]);let handleTransfer=async()=>{if(!y||!N||!A||!C||!j){console.log("Input field is not filled");return}if(!t)return;let e=(0,a.bM)(A,j);console.log("Message",e);let s=A.toString();try{let e=await (null==t?void 0:t.send({amount:s,currency:"eur",counterpart:{identifier:{standard:"iban",iban:j},details:{firstName:y,lastName:N,country:"ES"}},memo:C}));console.log("New log transactions",e);let n=await i.executeTransaction(e);console.log("TxResult",n),m.toast.success("Transaction processed")}catch(e){console.log("Error in transfer",e)}};return(0,n.jsxs)("div",{className:"px-4 flex gap-8 justify-center my-8",children:[o&&(0,n.jsx)(Userbalance,{closeMoneriumFlow:s,balances:o}),(0,n.jsxs)("div",{className:"flex justify-center items-center",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-4 border border-[#c4c1c1] px-[30px] py-[30px] rounded-[20px] ",children:[(0,n.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,n.jsx)(x.I,{value:y,type:"text",placeholder:"Enter First Name",onChange:e=>b(e.target.value)}),(0,n.jsx)(x.I,{value:N,type:"text",placeholder:"Enter last Name",onChange:e=>S(e.target.value)})]}),(0,n.jsx)(x.I,{type:"text",placeholder:"Enter amount",onChange:e=>{let t=e.target.value,s=parseFloat(t);isNaN(s)?console.log("Please enter a valid number"):k(s)}}),(0,n.jsx)(x.I,{value:C,type:"text",placeholder:"Info",onChange:e=>I(e.target.value)}),(0,n.jsx)(x.I,{value:j,type:"text",placeholder:"Enter the IBAN ",onChange:e=>w(e.target.value)}),(0,n.jsx)("button",{className:(0,f.d)(),onClick:handleTransfer,children:"Transfer"})]}),(0,n.jsx)("div",{children:P&&(0,n.jsxs)(n.Fragment,{children:[P===a.Kq.placed&&(0,n.jsx)("div",{children:"Order placed"}),P===a.Kq.pending&&(0,n.jsx)("div",{children:"Order pending"}),P===a.Kq.rejected&&(0,n.jsx)("div",{children:"Order rejected"}),P===a.Kq.processed&&(0,n.jsx)("div",{children:"Order processed"})]})})]})]})};let h="monerium_token";var page=()=>{let{isLoggedIn:e,selectedSafe:t,isSafeLoading:s,provider:u}=(0,r.useAuth)(),[x,g]=(0,d.useState)(),[v,p]=(0,d.useState)(),[j,w]=(0,d.useState)(),[y,b]=(0,d.useState)(),[N,S]=(0,d.useState)(),[A,k]=(0,d.useState)(),[C,I]=(0,d.useState)(),[P,E]=(0,d.useState)(),[F,L]=(0,d.useState)(),[O,M]=(0,d.useState)(!1),[_,T]=(0,d.useState)(!1);(0,d.useEffect)(()=>{(async()=>{if(!u||!t)return;T(!0);let e=await u.getSigner(),s=new l.EthersAdapter({ethers:c,signerOrProvider:e}),n=await o().create({ethAdapter:s,safeAddress:t,isL1SafeSingleton:!0});console.log("safe sdk",n),S(n);let r=new i.MoneriumPack({clientId:"2040e3b2-b2d4-11ee-a3f4-524d6b1e805e",environment:"sandbox"});await r.init({safeSdk:n}),w(r),T(!1),r.subscribe(a.Kq.pending,e=>{g(e.meta.state)}),r.subscribe(a.Kq.placed,e=>{g(e.meta.state)}),r.subscribe(a.Kq.rejected,e=>{g(e.meta.state),setTimeout(()=>{g(void 0)},5e3)}),r.subscribe(a.Kq.processed,e=>{g(e.meta.state),setTimeout(()=>{g(void 0)},5e3)});let d=await n.getThreshold(),f=await n.getOwners();p("".concat(d,"/").concat(f.length))})()},[u,t]),(0,d.useEffect)(()=>{let e=new URLSearchParams(window.location.search).get("code")||void 0,t=localStorage.getItem(h)||void 0;(e||t)&&startMoneriumFlow(e,t)},[j]);let startMoneriumFlow=async(e,t)=>{if(!j)return;M(!0);let s=await j.open({redirectUrl:"http://localhost:3000/pay",authCode:e,refreshToken:t}),n=await s.getAuthContext(),r=await s.getProfile(n.defaultProfile),a=await s.getBalances(),i=await s.getOrders();I(r),E(a),L(i),s.bearerProfile&&localStorage.setItem(h,s.bearerProfile.refresh_token),b(s),k(n),M(!1)},closeMoneriumFlow=async()=>{null==j||j.close(),localStorage.removeItem(h),k(void 0)};return(0,n.jsx)(n.Fragment,{children:e?(0,n.jsxs)("div",{className:"mt-12",children:[(0,n.jsx)("div",{className:"flex items-center justify-center text-4xl font-medium text-muted-foreground",children:"Pay with IBAN"}),_?(0,n.jsx)("div",{className:"flex items-center justify-center mt-4",children:"Setting Monerium Pack..."}):O?(0,n.jsx)("div",{className:"flex items-center justify-center",children:"Loading IBAN..."}):(0,n.jsx)(n.Fragment,{children:A?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,n.jsx)(pay_PayForm,{moneriumClient:y,closeMoneriumFlow:closeMoneriumFlow,protocolKit:N,moneriumPack:j,balances:P}),(0,n.jsx)(ibanDetails,{authContext:A,profile:C,balances:P,orders:F})]})}):(0,n.jsxs)(n.Fragment,{children:[!t&&(0,n.jsx)("div",{className:"flex ",children:(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("div",{className:"text-xl",children:"Safe is not deployed. Deploy a new oner"}),(0,n.jsx)("div",{className:(0,f.d)(),children:"Deploy Safe"}),(0,n.jsx)("button",{onClick:()=>m.toast.success("Safe Deployed!"),children:"toast"})]})}),t&&(0,n.jsx)(pay_LoginWithMonerium,{safe:t,threshold:v||"",onLogin:()=>startMoneriumFlow()})]})})]}):(0,n.jsx)("div",{className:"flex items-center justify-center mt-12",children:" You need to log In to Safe to access this."})})}},31379:function(e,t,s){"use strict";s.d(t,{Z:function(){return components_Address}});var n=s(57437),r=s(2265),hooks_useMemoizedAddressLabel=e=>{let t=(0,r.useMemo)(()=>{if(e){let t=e.slice(0,6),s=e.slice(e.length-6);return"".concat(t,"...").concat(s)}return e},[e]);return t},a=s(13402),i=s(81546),l=s(61396),o=s.n(l),components_Address=e=>{let{address:t,isTransactionAddress:s,showBlockExplorerLink:r,useFullAddress:l=!1,showCopyIntoClipboardButton:c=!0}=e,d=hooks_useMemoizedAddressLabel(t),u="https://sepolia.etherscan.io/".concat(s?"tx":"address","/").concat(t);return(0,n.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:[(0,n.jsx)("span",{children:l?t:d}),r&&u&&(0,n.jsx)(o(),{target:"_blank",href:u,children:(0,n.jsx)(a.jhj,{})}),c&&(0,n.jsx)("div",{onClick:()=>{var e,s,n;return null===(n=navigator)||void 0===n?void 0:null===(s=n.clipboard)||void 0===s?void 0:null===(e=s.writeText)||void 0===e?void 0:e.call(s,t)},children:(0,n.jsx)(i.AOF,{})})]})}},14977:function(e,t,s){"use strict";s.d(t,{I:function(){return i}});var n=s(57437),r=s(2265),a=s(81628);let i=r.forwardRef((e,t)=>{let{className:s,type:r,...i}=e;return(0,n.jsx)("input",{type:r,className:(0,a.cn)("flex h-12 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...i})});i.displayName="Input"},23611:function(e,t,s){"use strict";s.d(t,{d:function(){return o},z:function(){return c}});var n=s(57437),r=s(2265),a=s(67256),i=s(39213),l=s(81628);let o=(0,i.j)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"underline-offset-4 hover:underline text-primary"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,size:i,asChild:c=!1,...d}=e,u=c?a.g7:"button";return(0,n.jsx)(u,{className:(0,l.cn)(o({variant:r,size:i,className:s})),ref:t,...d})});c.displayName="Button"},49080:function(e,t,s){"use strict";s.r(t),s.d(t,{AuthContext:function(){return u},AuthContextProvider:function(){return AuthContextProvider},useAuth:function(){return useAuth}});var n=s(57437),r=s(2265),a=s(62406),i=s(31040),l=s.n(i),o=s(56955),c=s(19258),d=s(88216);let u=(0,r.createContext)({isLoggedIn:!1,selectedSafe:"",provider:null}),AuthContextProvider=e=>{let{children:t}=e,[s,f]=(0,r.useState)(),[x,m]=(0,r.useState)(!!(null==s?void 0:s.isAuthenticated)),[h,g]=(0,r.useState)(),[v,p]=(0,r.useState)(),[j,w]=(0,r.useState)(""),[y,b]=(0,r.useState)(),[N,S]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{S(!0);let e=new a.SafeAuthPack;await e.init({enableLogging:!1,buttonPosition:"bottom-right",showWidgetButton:!0,chainConfig:{chainId:"0x1",rpcTarget:"https://eth-mainnet.g.alchemy.com/v2/O-iXhEqwjAsyDI4OisBFziLrowNczff3"}}),f(e),e.subscribe("accountsChanged",async t=>{if(console.log("Accounts changed",t),t.length>0){let t=await (null==e?void 0:e.signIn());g(t),m(!0),t.safes&&t.safes.length>0&&w(null==t?void 0:t.safes[0])}}),S(!1)})()},[]),(0,r.useEffect)(()=>{s&&x&&p(new o.Q(s.getProvider()))},[x]),(0,r.useEffect)(()=>{(async()=>{if(!v||!j)return;let e=await v.getSigner(),t=new i.EthersAdapter({ethers:c,signerOrProvider:e}),s=await l().create({ethAdapter:t,safeAddress:j,isL1SafeSingleton:!0});b(s)})()},[v,j]);let logIn=async()=>{if(!s)return;let e=await s.signIn();g(e),m(!0),(null==e?void 0:e.safes)&&e.safes.length>0&&w(null==e?void 0:e.safes[0])},logOut=async()=>{s&&(await s.signOut(),p(void 0),g(void 0),m(!1))},deployNewSafeWallet=async()=>{if(!s||!v)return;let e=await v.getSigner(),t=new i.EthersAdapter({ethers:c,signerOrProvider:e}),n=await i.SafeFactory.create({ethAdapter:t}),r=await n.deploySafe({safeAccountConfig:{threshold:1,owners:[null==h?void 0:h.eoa]}}),a=await r.getAddress();a&&(w(a),d.toast.success("Safe Deployed!"))};return(0,n.jsx)(u.Provider,{value:{isLoggedIn:x,provider:v||null,data:h,logIn,logOut,selectedSafe:j,setSelectedSafe:w,deployNewSafeWallet,isSafeLoading:N,safeSDKKit:y,safeAuthPack:s},children:t})},useAuth=()=>{let e=r.useContext(u);if(void 0===e)throw Error("useAuth must be used within a AuthContextProvider");return e}},81628:function(e,t,s){"use strict";s.d(t,{cn:function(){return cn}});var n=s(50348),r=s(23986);function cn(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m)((0,n.clsx)(t))}}},function(e){e.O(0,[1866,3808,6051,7259,8922,4059,1396,6327,2971,2472,1744],function(){return e(e.s=50617)}),_N_E=e.O()}]);